<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button class="app-back-btn" text="חזרה" [defaultHref]="['/', 'tabs', 'store']"></ion-back-button>
    </ion-buttons>
    <ion-title class="ion-no-padding app-titles">עגלת קניות</ion-title>
    <ion-buttons slot="primary">
      <ion-button class="btn-cart" (click)="onEditItems()">
        <ion-icon name="cart-outline" class="toolbar-icon" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid [fixed]="true">

    <ion-row class="ion-no-padding ion-justify-content-center">
      <ion-col class="button tappable ion-text-right align-self-center category-title">פריטים בעגלה:</ion-col>
    </ion-row>

    <ion-row class="ion-no-padding">
      <ion-col size="12" size-xl="6" size-lg="4" size-md="3" size-sm="2"  class="ion-text-center" *ngIf="isLoading">
        <ion-spinner color="primary"></ion-spinner>
      </ion-col>
      <ion-col size="12" size-xl="12" size-lg="6" size-md="4" size-sm="5" class="ion-no-padding" *ngIf="!isLoading">
        <ion-list>
          <ion-item-sliding *ngFor="let item of cart.items" #slidingItem>
          <ion-item lines="inset" detail="false">
            <ion-thumbnail>
              <ion-img [src]="item?.thumbnail"></ion-img>
            </ion-thumbnail>
            <ion-label class="ion-no-padding ion-padding-start app-cart-item-label">
              <h1>{{ item.name }}</h1>
              <ion-text color="medium">
                <p>{{ item.category }}</p>
              </ion-text>
            </ion-label>
            <div class="units-select">
            <ion-label class="ion-text-center item-price-label">
              <ion-text>
                {{ (item.price * item.units) | currency:'ILS' }}
              </ion-text>
            </ion-label>
            <app-number-picker 
            [initialNumber]="item.units" 
            [min]="1" 
            [max]="10" 
            (numberPick)="onItemQuantityChange($event, item)"
            ></app-number-picker>
          </div>
        </ion-item>
        <ion-item-options side="end">
          <ion-item-option color="danger" (click)="onRemoveItem(item)">
            <ion-icon name="trash-outline" slot="icon-only"></ion-icon>
          </ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
        </ion-list>

      </ion-col>
    </ion-row>

    <ion-row class="ion-no-padding ion-justify-content-center">
      <ion-col class="button tappable ion-text-right align-self-center category-title">קופון:</ion-col>
    </ion-row>
    <ion-row class="ion-align-items-center">
      <ion-col class="ion-padding">
        <ion-input class="item-coupon-input" [(ngModel)]="couponCode" autocapitalize="characters"></ion-input>
      </ion-col>
      <ion-col class="ion-padding">
        <ion-button color="primary" fill="outline" (click)="onAddCoupon()">
          <ion-icon class="custom-coupons" slot="start"></ion-icon>
          <ion-label class="cart-activate-coupons-label">הפעל קופון</ion-label>
        </ion-button>
      </ion-col>
    </ion-row>

    <ion-row class="ion-no-padding ion-justify-content-center">
      <ion-col class="button tappable ion-text-right align-self-center category-title">סיכום:</ion-col>
    </ion-row>

    <ion-row class="ion-no-padding">
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-title-label">סכום ביניים</ion-label>
      </ion-col>
      <ion-col class="dotted-border-bottom  ion-no-padding ion-text-right">
      </ion-col>
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-price-label">{{ summaryItems | currency:'ILS' }}</ion-label>
      </ion-col>
    </ion-row>

    <ion-row class="ion-no-padding">
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-title-label">משלוח</ion-label>
      </ion-col>
      <ion-col class="dotted-border-bottom  ion-no-padding ion-text-right">
      </ion-col>
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-price-label">{{ shippingCost | currency:'ILS' }}</ion-label>
      </ion-col>
    </ion-row>

    <ion-row class="ion-no-padding" *ngIf="haveDiscount">
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-title-label">הנחה ({{ discountRate | percent:'1.0' }})</ion-label>
      </ion-col>
      <ion-col class="dotted-border-bottom  ion-no-padding ion-text-right">
      </ion-col>
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-price-label">{{ discount | currency:'ILS':'symbol':'1.3-3' }}</ion-label>
      </ion-col>
    </ion-row>

    <ion-row class="ion-no-padding">
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-title-label">סה'כ לתשלום</ion-label>
      </ion-col>
      <ion-col class="dotted-border-bottom  ion-no-padding ion-text-right">
      </ion-col>
      <ion-col size="auto" class="ion-text-right">
        <ion-label class="cart-summary-price-label">{{ summaryOrder | currency:'ILS' }}</ion-label>
      </ion-col>
    </ion-row>

  </ion-grid>
</ion-content>

<ion-footer class="add-participant-footer ion-no-padding">
  <ion-button expand="full" color="secondary" (click)="onMoveToPayment()" class="ion-no-padding">
    <ion-icon class="custom-cashier" slot="start"></ion-icon>
    <ion-label class="app-store-item-btn">המשך לתשלום</ion-label>
  </ion-button>
</ion-footer>